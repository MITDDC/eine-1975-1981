(DEF-DATA-FIELD DRAW-X-NEGATED 1 0)
(DEF-DATA-FIELD DRAW-Y-NEGATED 1 1)
(DEF-DATA-FIELD DRAW-X-Y-SWAPPED 1 2)

XDRAW-LINE (MISC-INST-ENTRY DRAW-LINE)
	((M-E) C-PDL-BUFFER-POINTER-POP)		;THE DRAW MODE, OA STYLE
	((M-D) C-PDL-BUFFER-POINTER-POP)		;DESTINATION Y
	((M-C) C-PDL-BUFFER-POINTER-POP)		;DESTINATION X
	((M-K) C-PDL-BUFFER-POINTER-POP)		;STARTING Y
	((M-J) C-PDL-BUFFER-POINTER-POP)		;STARTING X
	((M-A) SUB M-C A-J)				;DELTA X
	((M-B) SUB M-D A-K)				;DELTA Y
	(JUMP-IF-BIT-CLEAR				;IS A NEGATIVE?
		(BYTE-FIELD 1 22.) M-A XDRAW1)
	((M-A) SUB M-ZERO A-A)				;YES, POSITIVIZE IT
	((M-ZR) SELECTIVE-DEPOSIT (M-CONSTANT -1)	;   AND SET A FLAG.
		DRAW-X-NEGATED A-ZR)
XDRAW1	(JUMP-IF-BIT-CLEAR				;IS B NEGATIVE?
		(BYTE-FIELD 1 22.) M-B XDRAW2)
	((M-B) SUB M-ZERO A-B)				;YES, POSITIVIZE IT
	((M-ZR) SELECTIVE-DEPOSIT (M-CONSTANT -1)	;   AND SET A FLAG
		DRAW-Y-NEGATED A-ZR)
XDRAW2	(JUMP-IF-GREATER M-A A-B XDRAW3)		;IS A < B?
	((C-PDL-BUFFER-POINTER-PUSH) M-A)		;YES, SWAP A AND B
	((M-A) M-B)
	((M-B) C-PDL-BUFFER-POINTER-POP)
	((M-ZR) SELECTIVE-DEPOSIT (M-CONSTANT -1)	;   AND SET A FLAG
		DRAW-X-Y-SWAPPED A-ZR)
XDRAW3	((M-C) M-ZERO)					;START AT ZERO, STEP ONE EVERY TIME
	((M-D) M-ZERO)					;AND STEP Y SOMETIMES.
	((M-S) M-A (BYTE-FIELD 22. 1) A-ZERO)		;A/2
	((M-S) SUB M-ZERO A-S)				;THIS IS NOT HAIRILY BUMMED CODE...
	;HERE STARTS "DRAW-PLOT"
	(JUMP-IF-BIT-SET DRAW-X-Y-SWAPPED M-ZR XDRAW4)
	((M-R) 